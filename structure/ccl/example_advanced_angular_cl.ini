[ccl_comprehensive]
file = cosmosis-standard-library/structure/ccl/cl_with_ccl_modular.py

; ===== ADVANCED CCL ANGULAR_CL AND CORRELATION SHOWCASE =====
; This example demonstrates all advanced CCL features based on the documentation:
; - https://ccl.readthedocs.io/en/latest/api/pyccl.cells.html
; - https://ccl.readthedocs.io/en/latest/api/pyccl.correlations.html

; ===== GENERAL COMPUTATION CONTROL =====
compute_background = T
compute_power_spectra = T
compute_growth = T

; ===== ANGULAR POWER SPECTRA WITH ADVANCED OPTIONS =====
compute_gc = T                    ; Galaxy clustering
compute_shear = T                 ; Weak lensing shear
compute_cross = T                 ; Galaxy-shear cross-correlation
compute_cmb_lensing = T           ; CMB lensing cross-correlations

; ===== ADVANCED ANGULAR_CL INTEGRATION CONTROL =====
; Disable Limber approximation for high accuracy at low ell
limber_integration = F            ; Use exact integration (slower but more accurate)
non_limber_max_ell = 200         ; Exact integration up to ell=200, then Limber
integration_method = "qag_quad"   ; Integration method: "qag_quad", "spline", "riemann"
relative_tolerance = 1.0e-6       ; High precision (default: 1e-4)
absolute_tolerance = 1.0e-10      ; Absolute tolerance (default: 0.0)

; Advanced sampling control for angular_cl
p_of_k_a = "delta_matter:delta_matter"  ; Power spectrum to use
l_logstep = 1.05                 ; Fine logarithmic ell sampling (default: 1.15)
l_linstep = 20.0                 ; Fine linear ell sampling (default: 40.0)
dchi = 0.5                       ; Custom radial step size in Mpc (default: -1 = auto)
dlnchi = 0.01                    ; Custom log radial step size (default: -1 = auto)

; ===== CORRELATION FUNCTIONS - ALL CCL TYPES =====
; Angular correlation functions with all CCL correlation types
compute_xi = T                   ; Enable angular correlation functions
xi_type = "gg+"                  ; Options: "gg+", "gg-", "ll+", "ll-", "nn", "ng", "galaxy_shear"
xi_method = "fftlog"            ; Options: "fftlog" (fast), "bessel" (accurate), "legendre"
theta_min = 0.05                ; Minimum angle (arcmin) - finer than default
theta_max = 500.0               ; Maximum angle (arcmin) - wider than default
n_theta = 100                   ; Number of angular bins - more than default

; ===== 3D CORRELATION FUNCTIONS =====
; Real-space 3D correlation function xi(r)
compute_xi_3d = T               ; Enable 3D correlation functions
r_min_3d = 0.05                 ; Minimum distance (Mpc)
r_max_3d = 300.0                ; Maximum distance (Mpc)
n_r_3d = 80                     ; Number of distance bins
z_eval_3d = 0.7                 ; Redshift for evaluation

; ===== RSD CORRELATION FUNCTIONS =====
; Redshift-space distortions: xi(r,mu) and xi(pi,sigma)
compute_xi_rsd = T              ; Enable RSD correlation functions
rsd_beta = 0.45                 ; RSD parameter f/b (growth rate / bias)

; ===== CORRELATION FUNCTION MULTIPOLES =====
; Multipoles xi_ell(r) for ell = 0, 2, 4, 6, ...
compute_xi_multipoles = T       ; Enable correlation multipoles
multipole_ells = "0 2 4 6"      ; Custom multipoles (default: "0 2 4")

; ===== ELL CONFIGURATION FOR HIGH RESOLUTION =====
ell_min_logspaced = 2.0         ; Start from ell=2 (minimum for shear)
ell_max_logspaced = 20000.0     ; High ell for small-scale accuracy
n_ell_logspaced = 200           ; High resolution ell sampling

; ===== COSMOLOGY SETUP =====
transfer_function = "boltzmann_camb"
matter_power_spectrum = "camb"
halofit_version = "mead2020"

; ===== REDSHIFT AND K RANGES =====
z_min = 0.0
z_max = 4.0                     ; Extended redshift range
n_z = 200                       ; High resolution
k_min = 1.0e-5                  ; Extended k range
k_max = 20.0
n_k = 300                       ; High resolution

; ===== EXAMPLE RESULTS =====
; This configuration will produce:
;
; Angular Power Spectra (with advanced integration):
; - [galaxy_cl]: C_ell^ij for galaxy clustering with exact integration up to ell=200
; - [shear_cl]: C_ell^ij for cosmic shear with high precision tolerances
; - [galaxy_shear_cl]: C_ell^ij for galaxy-shear cross-correlation
; - [cmb_galaxy_cl]: CMB lensing - galaxy clustering cross-correlation
; - [cmb_shear_cl]: CMB lensing - cosmic shear cross-correlation
;
; Angular Correlation Functions:
; - [galaxy_xi_plus]: w(theta) for galaxy clustering using FFTLog method
;
; 3D Correlation Functions:
; - [correlation_3d]: xi(r) real-space correlation function at z=0.7
;
; RSD Correlation Functions:
; - [correlation_rsd]: xi_rsd(r) averaged over angles (monopole)
; - [correlation_pi_sigma]: xi(pi,sigma) in (pi,sigma) space
;
; Correlation Function Multipoles:
; - [correlation_multipole_ell_0]: xi_0(r) monopole
; - [correlation_multipole_ell_2]: xi_2(r) quadrupole  
; - [correlation_multipole_ell_4]: xi_4(r) hexadecapole
; - [correlation_multipole_ell_6]: xi_6(r) 64-pole
;
; All computed with high precision and fine sampling for publication-quality results.
;
; Performance Notes:
; - Non-Limber integration (limber_integration = F) is slower but more accurate
; - High precision tolerances increase computation time
; - Fine sampling (high n_ell, n_theta, n_r) increases memory usage
; - Multiple correlation types and methods provide comprehensive analysis
